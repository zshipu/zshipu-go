<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>ã€Œè¿è½½åäºŒã€ä¼˜åŒ–é…ç½®ç»“æ„åŠå®ç°å›¾ç‰‡ä¸Šä¼  | çŸ¥è¯†é“ºçš„åšå®¢</title>
    <meta property="og:title" content="ã€Œè¿è½½åäºŒã€ä¼˜åŒ–é…ç½®ç»“æ„åŠå®ç°å›¾ç‰‡ä¸Šä¼  - çŸ¥è¯†é“ºçš„åšå®¢">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2018-05-27T12:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2018-05-27T12:00:00&#43;08:00'>
        
    <meta name="Keywords" content="golang,goè¯­è¨€,goè¯­è¨€ç¬”è®°,çŸ¥è¯†é“º,java,android,åšå®¢,é¡¹ç›®ç®¡ç†,python,è½¯ä»¶æ¶æ„,å…¬ä¼—å·,å°ç¨‹åº">
    <meta name="description" content="ã€Œè¿è½½åäºŒã€ä¼˜åŒ–é…ç½®ç»“æ„åŠå®ç°å›¾ç‰‡ä¸Šä¼ ">
        <meta name="author" content="çŸ¥è¯†é“º">
        
    <meta property="og:url" content="https://go.zshipu.com/posts/go/gin/2018-05-27-config-upload/">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    <script data-ad-client="ca-pub-2874221941555456" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
    
    
    
    
    
    
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WLWJSST');</script>
    
</head>


<body>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WLWJSST"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://go.zshipu.com/">
                        çŸ¥è¯†é“ºçš„åšå®¢
                    </a>
                
                <p class="description">ä¸“æ³¨äºAndroidã€Javaã€Goè¯­è¨€(golang)ã€ç§»åŠ¨äº’è”ç½‘ã€é¡¹ç›®ç®¡ç†ã€è½¯ä»¶æ¶æ„</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://go.zshipu.com/">é¦–é¡µ</a>
                    
                    <a  href="https://go.zshipu.com/archives/" title="å½’æ¡£">å½’æ¡£</a>
                    
                    <a  href="https://go.zshipu.com/about/" title="å…³äº">å…³äº</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: fixed;
        width: 200px;
        margin-left: -210px;
        padding: 5px 10px;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        border: 1px solid rgba(0, 0, 0, .07);
        border-radius: 5px;
        background-color: rgba(255, 255, 255, 0.98);
        background-clip: padding-box;
        -webkit-box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        word-wrap: break-word;
        white-space: nowrap;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        z-index: 999;
        cursor: pointer;
        max-height: 70%;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="position: absolute; top: 188px;">
    <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#çŸ¥è¯†ç‚¹">çŸ¥è¯†ç‚¹</a></li>
<li><a href="#æœ¬æ–‡ç›®æ ‡">æœ¬æ–‡ç›®æ ‡</a></li>
<li><a href="#å‰è¨€">å‰è¨€</a></li>
<li><a href="#ä¼˜åŒ–é…ç½®ç»“æ„">ä¼˜åŒ–é…ç½®ç»“æ„</a>
<ul>
<li><a href="#ä¸€-è®²è§£">ä¸€ã€è®²è§£</a>
<ul>
<li><a href="#æ˜ å°„ç»“æ„ä½“-ç¤ºä¾‹">æ˜ å°„ç»“æ„ä½“ï¼ˆç¤ºä¾‹ï¼‰</a></li>
<li><a href="#é…ç½®ç»Ÿç®¡">é…ç½®ç»Ÿç®¡</a></li>
</ul></li>
<li><a href="#äºŒ-è½å®">äºŒã€è½å®</a>
<ul>
<li><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶">ä¿®æ”¹é…ç½®æ–‡ä»¶</a></li>
<li><a href="#ä¼˜åŒ–é…ç½®è¯»å–åŠè®¾ç½®åˆå§‹åŒ–é¡ºåº">ä¼˜åŒ–é…ç½®è¯»å–åŠè®¾ç½®åˆå§‹åŒ–é¡ºåº</a>
<ul>
<li><a href="#ç¬¬ä¸€æ­¥">ç¬¬ä¸€æ­¥</a></li>
<li><a href="#ç¬¬äºŒæ­¥">ç¬¬äºŒæ­¥</a></li>
<li><a href="#éªŒè¯">éªŒè¯</a></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#æŠ½ç¦»-file">æŠ½ç¦» File</a>
<ul>
<li><a href="#ç¬¬ä¸€æ­¥-1">ç¬¬ä¸€æ­¥</a></li>
<li><a href="#ç¬¬äºŒæ­¥-1">ç¬¬äºŒæ­¥</a></li>
</ul></li>
<li><a href="#å®ç°ä¸Šä¼ å›¾ç‰‡æ¥å£">å®ç°ä¸Šä¼ å›¾ç‰‡æ¥å£</a>
<ul>
<li><a href="#ç¬¬é›¶æ­¥">ç¬¬é›¶æ­¥</a></li>
<li><a href="#ç¬¬ä¸€æ­¥-2">ç¬¬ä¸€æ­¥</a></li>
<li><a href="#ç¬¬äºŒæ­¥-2">ç¬¬äºŒæ­¥</a></li>
<li><a href="#ç¬¬ä¸‰æ­¥">ç¬¬ä¸‰æ­¥</a></li>
<li><a href="#éªŒè¯-1">éªŒè¯</a></li>
</ul></li>
<li><a href="#å®ç°-http-fileserver">å®ç° http.FileServer</a>
<ul>
<li><a href="#r-staticfs">r.StaticFS</a></li>
<li><a href="#å®ƒåšäº†ä»€ä¹ˆ">å®ƒåšäº†ä»€ä¹ˆ</a>
<ul>
<li><a href="#http-stripprefix">http.StripPrefix</a></li>
<li><a href="#filepath">/*filepath</a></li>
</ul></li>
<li><a href="#éªŒè¯-2">éªŒè¯</a></li>
</ul></li>
<li><a href="#ä¿®æ”¹æ–‡ç« æ¥å£">ä¿®æ”¹æ–‡ç« æ¥å£</a></li>
<li><a href="#æ€»ç»“">æ€»ç»“</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            var leftPos = $("#main").offset().left;
            if(leftPos<220){
                postToc.css({"width":leftPos-10,"margin-left":(0-leftPos)})
            }

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t
                    },
                    process: {
                        position: "fixed",
                        top: 20
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }
    })
</script>
    <article class="post">
        <header>
            <h1 class="post-title">ã€Œè¿è½½åäºŒã€ä¼˜åŒ–é…ç½®ç»“æ„åŠå®ç°å›¾ç‰‡ä¸Šä¼ </h1>
        </header>
        <date class="post-meta meta-date">
            2018å¹´5æœˆ27æ—¥
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    é˜…è¯»</span></span>
        </div>
        
        
        <div class="clear" style="display: none">
            <div class="toc-article">
                <div class="toc-title">æ–‡ç« ç›®å½•</div>
            </div>
        </div>
        
        <div class="post-content">
            

<h2 id="çŸ¥è¯†ç‚¹">çŸ¥è¯†ç‚¹</h2>

<ul>
<li>é‡æ„ã€è°ƒæ•´ç»“æ„</li>
</ul>

<h2 id="æœ¬æ–‡ç›®æ ‡">æœ¬æ–‡ç›®æ ‡</h2>

<p>è¿™ä¸ªåº”ç”¨ç¨‹åºè·‘äº†é‚£ä¹ˆä¹…äº†ï¼Œè¶Šæ¥è¶Šå¤§ï¼Œè¶Šæ¥è¶Šå£®ï¼Œä»¿ä½›æˆ‘ä»¬çš„äº§å“ä¸€æ ·ï¼Œç°åœ¨å®ƒéœ€è¦è¿›è¡Œå°èŒƒå›´é‡æ„äº†ï¼Œä»¥ä¾¿äºåç»­çš„ä½¿ç”¨ï¼Œè¿™éå¸¸é‡è¦ã€‚</p>

<h2 id="å‰è¨€">å‰è¨€</h2>

<p>ä¸€å¤©ï¼Œäº§å“ç»ç†çªç„¶è·Ÿä½ è¯´æ–‡ç« åˆ—è¡¨ï¼Œæ²¡æœ‰å°é¢å›¾ï¼Œä¸å¤Ÿç¾è§‚ï¼Œï¼ï¼‰&amp;ï¿¥*ï¼&amp;ï¼‰#&amp;ï¿¥*ï¼åŠ ä¸€ä¸ªå§ï¼Œå‡ åˆ†é’Ÿçš„äº‹</p>

<p>ä½ æ‰“å¼€ä½ çš„ç¨‹åºï¼Œåˆ†æäº†ä¸€æ³¢å†™äº†ä¸ªæ¸…å•ï¼š</p>

<ul>
<li>ä¼˜åŒ–é…ç½®ç»“æ„ï¼ˆå› ä¸ºé…ç½®é¡¹è¶Šæ¥è¶Šå¤šï¼‰</li>
<li>æŠ½ç¦» åŸ logging çš„ File ä¾¿äºå…¬ç”¨ï¼ˆloggingã€upload å„ä¿æœ‰ä¸€ä»½å¹¶ä¸åˆé€‚ï¼‰</li>
<li>å®ç°ä¸Šä¼ å›¾ç‰‡æ¥å£ï¼ˆéœ€é™åˆ¶æ–‡ä»¶æ ¼å¼ã€å¤§å°ï¼‰</li>
<li>ä¿®æ”¹æ–‡ç« æ¥å£ï¼ˆéœ€æ”¯æŒå°é¢åœ°å€å‚æ•°ï¼‰</li>
<li>å¢åŠ  blog_article ï¼ˆæ–‡ç« ï¼‰çš„æ•°æ®åº“å­—æ®µ</li>
<li>å®ç° http.FileServer</li>
</ul>

<p>å—¯ï¼Œä½ å‘ç°è¦è¾ƒä¼˜çš„è¯ï¼Œéœ€è¦è°ƒæ•´éƒ¨åˆ†çš„åº”ç”¨ç¨‹åºç»“æ„ï¼Œå› ä¸ºåŠŸèƒ½è¶Šæ¥è¶Šå¤šï¼ŒåŸæœ¬çš„è®¾è®¡ä¹Ÿè¦è·Ÿä¸ŠèŠ‚å¥</p>

<p>ä¹Ÿå°±æ˜¯åœ¨é€‚å½“çš„æ—¶å€™ï¼ŒåŠæ—¶ä¼˜åŒ–</p>

<h2 id="ä¼˜åŒ–é…ç½®ç»“æ„">ä¼˜åŒ–é…ç½®ç»“æ„</h2>

<h3 id="ä¸€-è®²è§£">ä¸€ã€è®²è§£</h3>

<p>åœ¨å…ˆå‰ç« èŠ‚ä¸­ï¼Œé‡‡ç”¨äº†ç›´æ¥è¯»å– KEY çš„æ–¹å¼å»å­˜å‚¨é…ç½®é¡¹ï¼Œè€Œæœ¬æ¬¡éœ€æ±‚ä¸­ï¼Œéœ€è¦å¢åŠ å›¾ç‰‡çš„é…ç½®é¡¹ï¼Œæ€»ä½“å°±æœ‰äº›å†—ä½™äº†</p>

<p>æˆ‘ä»¬é‡‡ç”¨ä»¥ä¸‹è§£å†³æ–¹æ³•ï¼š</p>

<ul>
<li>æ˜ å°„ç»“æ„ä½“ï¼šä½¿ç”¨ MapTo æ¥è®¾ç½®é…ç½®å‚æ•°</li>
<li>é…ç½®ç»Ÿç®¡ï¼šæ‰€æœ‰çš„é…ç½®é¡¹ç»Ÿç®¡åˆ° setting ä¸­</li>
</ul>

<h4 id="æ˜ å°„ç»“æ„ä½“-ç¤ºä¾‹">æ˜ å°„ç»“æ„ä½“ï¼ˆç¤ºä¾‹ï¼‰</h4>

<p>åœ¨ go-ini ä¸­å¯ä»¥é‡‡ç”¨ MapTo çš„æ–¹å¼æ¥æ˜ å°„ç»“æ„ä½“ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-go">type Server struct {
	RunMode string
	HttpPort int
	ReadTimeout time.Duration
	WriteTimeout time.Duration
}

var ServerSetting = &amp;Server{}

func main() {
    Cfg, err := ini.Load(&quot;conf/app.ini&quot;)
	if err != nil {
		log.Fatalf(&quot;Fail to parse 'conf/app.ini': %v&quot;, err)
	}

	err = Cfg.Section(&quot;server&quot;).MapTo(ServerSetting)
	if err != nil {
		log.Fatalf(&quot;Cfg.MapTo ServerSetting err: %v&quot;, err)
	}
}
</code></pre>

<p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œå¯ä»¥æ³¨æ„ ServerSetting å–äº†åœ°å€ï¼Œä¸ºä»€ä¹ˆ MapTo å¿…é¡»åœ°å€å…¥å‚å‘¢ï¼Ÿ</p>

<pre><code class="language-go">// MapTo maps section to given struct.
func (s *Section) MapTo(v interface{}) error {
	typ := reflect.TypeOf(v)
	val := reflect.ValueOf(v)
	if typ.Kind() == reflect.Ptr {
		typ = typ.Elem()
		val = val.Elem()
	} else {
		return errors.New(&quot;cannot map to non-pointer struct&quot;)
	}

	return s.mapTo(val, false)
}
</code></pre>

<p>åœ¨ MapTo ä¸­ <code>typ.Kind() == reflect.Ptr</code> çº¦æŸäº†å¿…é¡»ä½¿ç”¨æŒ‡é’ˆï¼Œå¦åˆ™ä¼šè¿”å› <code>cannot map to non-pointer struct</code> çš„é”™è¯¯ã€‚è¿™ä¸ªæ˜¯è¡¨é¢åŸå› </p>

<p>æ›´å¾€å†…æ¢ç©¶ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ <code>field.Set</code> çš„åŸå› ï¼Œå½“æ‰§è¡Œ <code>val := reflect.ValueOf(v)</code> ï¼Œå‡½æ•°é€šè¿‡ä¼ é€’ <code>v</code> æ‹·è´åˆ›å»ºäº† <code>val</code>ï¼Œä½†æ˜¯ <code>val</code> çš„æ”¹å˜å¹¶ä¸èƒ½æ›´æ”¹åŸå§‹çš„ <code>v</code>ï¼Œè¦æƒ³ <code>val</code> çš„æ›´æ”¹èƒ½ä½œç”¨åˆ° <code>v</code>ï¼Œåˆ™å¿…é¡»ä¼ é€’ <code>v</code> çš„åœ°å€</p>

<p>æ˜¾ç„¶ go-ini é‡Œä¹Ÿæ˜¯åŒ…å«ä¿®æ”¹åŸå§‹å€¼è¿™ä¸€é¡¹åŠŸèƒ½çš„ï¼Œä½ è§‰å¾—æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ</p>

<h4 id="é…ç½®ç»Ÿç®¡">é…ç½®ç»Ÿç®¡</h4>

<p>åœ¨å…ˆå‰çš„ç‰ˆæœ¬ä¸­ï¼Œmodels å’Œ file çš„é…ç½®æ˜¯åœ¨è‡ªå·±çš„æ–‡ä»¶ä¸­è§£æçš„ï¼Œè€Œå…¶ä»–åœ¨ setting.go ä¸­ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†å…¶åœ¨ setting ä¸­ç»Ÿä¸€æ¥ç®¡</p>

<p>ä½ å¯èƒ½ä¼šæƒ³ï¼Œç›´æ¥æŠŠä¸¤è€…çš„é…ç½®é¡¹å¤åˆ¶ç²˜è´´åˆ° setting.go çš„ init ä¸­ï¼Œä¸€ä¸‹å­å°±å®Œäº‹äº†ï¼Œæé‚£ä¹ˆéº»çƒ¦ï¼Ÿ</p>

<p>ä½†ä½ åœ¨æƒ³æƒ³ï¼Œå…ˆå‰çš„ä»£ç ä¸­å­˜åœ¨å¤šä¸ª init å‡½æ•°ï¼Œæ‰§è¡Œé¡ºåºå­˜åœ¨é—®é¢˜ï¼Œæ— æ³•è¾¾åˆ°æˆ‘ä»¬çš„è¦æ±‚ï¼Œä½ å¯ä»¥è¯•è¯•</p>

<p>ï¼ˆæ­¤å¤„æ˜¯ä¸€ä¸ªåŸºç¡€çŸ¥è¯†ç‚¹ï¼‰</p>

<p>åœ¨ Go ä¸­ï¼Œå½“å­˜åœ¨å¤šä¸ª init å‡½æ•°æ—¶ï¼Œæ‰§è¡Œé¡ºåºä¸ºï¼š</p>

<ul>
<li>ç›¸åŒåŒ…ä¸‹çš„ init å‡½æ•°ï¼šæŒ‰ç…§æºæ–‡ä»¶ç¼–è¯‘é¡ºåºå†³å®šæ‰§è¡Œé¡ºåºï¼ˆé»˜è®¤æŒ‰æ–‡ä»¶åæ’åºï¼‰</li>
<li>ä¸åŒåŒ…ä¸‹çš„ init å‡½æ•°ï¼šæŒ‰ç…§åŒ…å¯¼å…¥çš„ä¾èµ–å…³ç³»å†³å®šå…ˆåé¡ºåº</li>
</ul>

<p>æ‰€ä»¥è¦é¿å…å¤š init çš„æƒ…å†µï¼Œ<strong>å°½é‡ç”±ç¨‹åºæŠŠæ§åˆå§‹åŒ–çš„å…ˆåé¡ºåº</strong></p>

<h3 id="äºŒ-è½å®">äºŒã€è½å®</h3>

<h4 id="ä¿®æ”¹é…ç½®æ–‡ä»¶">ä¿®æ”¹é…ç½®æ–‡ä»¶</h4>

<p>æ‰“å¼€ conf/app.ini å°†é…ç½®æ–‡ä»¶ä¿®æ”¹ä¸ºå¤§é©¼å³°å‘½åï¼Œå¦å¤–æˆ‘ä»¬å¢åŠ äº† 5 ä¸ªé…ç½®é¡¹ç”¨äºä¸Šä¼ å›¾ç‰‡çš„åŠŸèƒ½ï¼Œ4 ä¸ªæ–‡ä»¶æ—¥å¿—æ–¹é¢çš„é…ç½®é¡¹</p>

<pre><code class="language-ini">[app]
PageSize = 10
JwtSecret = 233

RuntimeRootPath = runtime/

ImagePrefixUrl = http://127.0.0.1:8000
ImageSavePath = upload/images/
# MB
ImageMaxSize = 5
ImageAllowExts = .jpg,.jpeg,.png

LogSavePath = logs/
LogSaveName = log
LogFileExt = log
TimeFormat = 20060102

[server]
#debug or release
RunMode = debug
HttpPort = 8000
ReadTimeout = 60
WriteTimeout = 60

[database]
Type = mysql
User = root
Password = rootroot
Host = 127.0.0.1:3306
Name = blog
TablePrefix = blog_
</code></pre>

<h4 id="ä¼˜åŒ–é…ç½®è¯»å–åŠè®¾ç½®åˆå§‹åŒ–é¡ºåº">ä¼˜åŒ–é…ç½®è¯»å–åŠè®¾ç½®åˆå§‹åŒ–é¡ºåº</h4>

<h5 id="ç¬¬ä¸€æ­¥">ç¬¬ä¸€æ­¥</h5>

<p>å°†æ•£è½åœ¨å…¶ä»–æ–‡ä»¶é‡Œçš„é…ç½®éƒ½åˆ æ‰ï¼Œ<strong>ç»Ÿä¸€åœ¨ setting ä¸­å¤„ç†</strong>ä»¥åŠ<strong>ä¿®æ”¹ init å‡½æ•°ä¸º Setup æ–¹æ³•</strong></p>

<p>æ‰“å¼€ pkg/setting/setting.go æ–‡ä»¶ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p>

<pre><code class="language-go">package setting

import (
	&quot;log&quot;
	&quot;time&quot;

	&quot;github.com/go-ini/ini&quot;
)

type App struct {
	JwtSecret string
	PageSize int
	RuntimeRootPath string

	ImagePrefixUrl string
	ImageSavePath string
	ImageMaxSize int
	ImageAllowExts []string

	LogSavePath string
	LogSaveName string
	LogFileExt string
	TimeFormat string
}

var AppSetting = &amp;App{}

type Server struct {
	RunMode string
	HttpPort int
	ReadTimeout time.Duration
	WriteTimeout time.Duration
}

var ServerSetting = &amp;Server{}

type Database struct {
	Type string
	User string
	Password string
	Host string
	Name string
	TablePrefix string
}

var DatabaseSetting = &amp;Database{}

func Setup() {
	Cfg, err := ini.Load(&quot;conf/app.ini&quot;)
	if err != nil {
		log.Fatalf(&quot;Fail to parse 'conf/app.ini': %v&quot;, err)
	}

	err = Cfg.Section(&quot;app&quot;).MapTo(AppSetting)
	if err != nil {
		log.Fatalf(&quot;Cfg.MapTo AppSetting err: %v&quot;, err)
	}

	AppSetting.ImageMaxSize = AppSetting.ImageMaxSize * 1024 * 1024

	err = Cfg.Section(&quot;server&quot;).MapTo(ServerSetting)
	if err != nil {
		log.Fatalf(&quot;Cfg.MapTo ServerSetting err: %v&quot;, err)
	}

	ServerSetting.ReadTimeout = ServerSetting.ReadTimeout * time.Second
	ServerSetting.WriteTimeout = ServerSetting.WriteTimeout * time.Second

	err = Cfg.Section(&quot;database&quot;).MapTo(DatabaseSetting)
	if err != nil {
		log.Fatalf(&quot;Cfg.MapTo DatabaseSetting err: %v&quot;, err)
	}
}
</code></pre>

<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åšäº†å¦‚ä¸‹å‡ ä»¶äº‹ï¼š</p>

<ul>
<li>ç¼–å†™ä¸é…ç½®é¡¹ä¿æŒä¸€è‡´çš„ç»“æ„ä½“ï¼ˆAppã€Serverã€Databaseï¼‰</li>
<li>ä½¿ç”¨ MapTo å°†é…ç½®é¡¹æ˜ å°„åˆ°ç»“æ„ä½“ä¸Š</li>
<li>å¯¹ä¸€äº›éœ€ç‰¹æ®Šè®¾ç½®çš„é…ç½®é¡¹è¿›è¡Œå†èµ‹å€¼</li>
</ul>

<p><strong>éœ€è¦ä½ å»åšçš„äº‹ï¼š</strong></p>

<ul>
<li>å°† <a href="https://github.com/zshipu/go-gin-example/blob/a338ddec103c9506b4c7ed16d9f5386040d99b4b/models/models.go#L23">models.go</a>ã€<a href="https://github.com/zshipu/go-gin-example/blob/a338ddec103c9506b4c7ed16d9f5386040d99b4b/pkg/setting/setting.go#L23">setting.go</a>ã€<a href="https://github.com/zshipu/go-gin-example/blob/a338ddec103c9506b4c7ed16d9f5386040d99b4b/pkg/logging/log.go#L32-L37">pkg/logging/log.go</a> çš„ init å‡½æ•°ä¿®æ”¹ä¸º Setup æ–¹æ³•</li>
<li>å°† <a href="https://github.com/zshipu/go-gin-example/blob/a338ddec103c9506b4c7ed16d9f5386040d99b4b/models/models.go#L23-L39">models/models.go</a> ç‹¬ç«‹è¯»å–çš„ DB é…ç½®é¡¹åˆ é™¤ï¼Œæ”¹ä¸ºç»Ÿä¸€è¯»å– setting</li>
<li>å°† <a href="https://github.com/zshipu/go-gin-example/blob/a338ddec103c9506b4c7ed16d9f5386040d99b4b/pkg/logging/file.go#L10-L15">pkg/logging/file</a> ç‹¬ç«‹çš„ LOG é…ç½®é¡¹åˆ é™¤ï¼Œæ”¹ä¸ºç»Ÿä¸€è¯»å– setting</li>
</ul>

<p>è¿™å‡ é¡¹æ¯”è¾ƒåŸºç¡€ï¼Œå¹¶æ²¡æœ‰è´´å‡ºæ¥ï¼Œæˆ‘å¸Œæœ›ä½ å¯ä»¥è‡ªå·±åŠ¨æ‰‹ï¼Œæœ‰é—®é¢˜çš„è¯å¯å³æ‹ <a href="https://github.com/zshipu/go-gin-example">é¡¹ç›®åœ°å€</a></p>

<h5 id="ç¬¬äºŒæ­¥">ç¬¬äºŒæ­¥</h5>

<p>åœ¨è¿™ä¸€æ­¥æˆ‘ä»¬è¦è®¾ç½®åˆå§‹åŒ–çš„æµç¨‹ï¼Œæ‰“å¼€ main.go æ–‡ä»¶ï¼Œä¿®æ”¹å†…å®¹ï¼š</p>

<pre><code class="language-go">func main() {
	setting.Setup()
	models.Setup()
	logging.Setup()

	endless.DefaultReadTimeOut = setting.ServerSetting.ReadTimeout
	endless.DefaultWriteTimeOut = setting.ServerSetting.WriteTimeout
	endless.DefaultMaxHeaderBytes = 1 &lt;&lt; 20
	endPoint := fmt.Sprintf(&quot;:%d&quot;, setting.ServerSetting.HttpPort)

	server := endless.NewServer(endPoint, routers.InitRouter())
	server.BeforeBegin = func(add string) {
		log.Printf(&quot;Actual pid is %d&quot;, syscall.Getpid())
	}

	err := server.ListenAndServe()
	if err != nil {
		log.Printf(&quot;Server err: %v&quot;, err)
	}
}
</code></pre>

<p>ä¿®æ”¹å®Œæ¯•åï¼Œå°±æˆåŠŸå°†å¤šæ¨¡å—çš„åˆå§‹åŒ–å‡½æ•°æ”¾åˆ°å¯åŠ¨æµç¨‹ä¸­äº†ï¼ˆå…ˆåé¡ºåºä¹Ÿå¯ä»¥æ§åˆ¶ï¼‰</p>

<h5 id="éªŒè¯">éªŒè¯</h5>

<p>åœ¨è¿™é‡Œä¸ºæ­¢ï¼Œé’ˆå¯¹æœ¬éœ€æ±‚çš„é…ç½®ä¼˜åŒ–å°±å®Œæ¯•äº†ï¼Œä½ éœ€è¦æ‰§è¡Œ <code>go run main.go</code> éªŒè¯ä¸€ä¸‹ä½ çš„åŠŸèƒ½æ˜¯å¦æ­£å¸¸å“¦</p>

<p>é¡ºå¸¦ç•™ä¸ªåŸºç¡€é—®é¢˜ï¼Œå¤§å®¶å¯ä»¥æ€è€ƒä¸‹</p>

<pre><code class="language-go">ServerSetting.ReadTimeout = ServerSetting.ReadTimeout * time.Second
ServerSetting.WriteTimeout = ServerSetting.ReadTimeout * time.Second
</code></pre>

<p>è‹¥å°† setting.go æ–‡ä»¶ä¸­çš„è¿™ä¸¤è¡Œåˆ é™¤ï¼Œä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>

<h2 id="æŠ½ç¦»-file">æŠ½ç¦» File</h2>

<p>åœ¨å…ˆå‰ç‰ˆæœ¬ä¸­ï¼Œåœ¨ <a href="https://github.com/zshipu/go-gin-example/blob/a338ddec103c9506b4c7ed16d9f5386040d99b4b/pkg/logging/file.go">logging/file.go</a> ä¸­ä½¿ç”¨åˆ°äº† os çš„ä¸€äº›æ–¹æ³•ï¼Œæˆ‘ä»¬é€šè¿‡å‰æœŸè§„åˆ’å‘ç°ï¼Œè¿™éƒ¨åˆ†åœ¨ä¸Šä¼ å›¾ç‰‡åŠŸèƒ½ä¸­å¯ä»¥å¤ç”¨</p>

<h3 id="ç¬¬ä¸€æ­¥-1">ç¬¬ä¸€æ­¥</h3>

<p>åœ¨ pkg ç›®å½•ä¸‹æ–°å»º file/file.go ï¼Œå†™å…¥æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>

<pre><code class="language-go">package file

import (
	&quot;os&quot;
	&quot;path&quot;
	&quot;mime/multipart&quot;
	&quot;io/ioutil&quot;
)

func GetSize(f multipart.File) (int, error) {
	content, err := ioutil.ReadAll(f)

	return len(content), err
}

func GetExt(fileName string) string {
	return path.Ext(fileName)
}

func CheckNotExist(src string) bool {
	_, err := os.Stat(src)

	return os.IsNotExist(err)
}

func CheckPermission(src string) bool {
	_, err := os.Stat(src)

	return os.IsPermission(err)
}

func IsNotExistMkDir(src string) error {
	if notExist := CheckNotExist(src); notExist == true {
		if err := MkDir(src); err != nil {
			return err
		}
	}

	return nil
}

func MkDir(src string) error {
	err := os.MkdirAll(src, os.ModePerm)
	if err != nil {
		return err
	}

	return nil
}

func Open(name string, flag int, perm os.FileMode) (*os.File, error) {
	f, err := os.OpenFile(name, flag, perm)
	if err != nil {
		return nil, err
	}

	return f, nil
}
</code></pre>

<p>åœ¨è¿™é‡Œæˆ‘ä»¬ä¸€å…±å°è£…äº† 7 ä¸ª æ–¹æ³•</p>

<ul>
<li>GetSizeï¼šè·å–æ–‡ä»¶å¤§å°</li>
<li>GetExtï¼šè·å–æ–‡ä»¶åç¼€</li>
<li>CheckNotExistï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</li>
<li>CheckPermissionï¼šæ£€æŸ¥æ–‡ä»¶æƒé™</li>
<li>IsNotExistMkDirï¼šå¦‚æœä¸å­˜åœ¨åˆ™æ–°å»ºæ–‡ä»¶å¤¹</li>
<li>MkDirï¼šæ–°å»ºæ–‡ä»¶å¤¹</li>
<li>Openï¼šæ‰“å¼€æ–‡ä»¶</li>
</ul>

<p>åœ¨è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°äº† <code>mime/multipart</code> åŒ…ï¼Œå®ƒä¸»è¦å®ç°äº† MIME çš„ multipart è§£æï¼Œä¸»è¦é€‚ç”¨äº <a href="https://tools.ietf.org/html/rfc2388">HTTP</a> å’Œå¸¸è§æµè§ˆå™¨ç”Ÿæˆçš„ multipart ä¸»ä½“</p>

<p>multipart åˆæ˜¯ä»€ä¹ˆï¼Œ<a href="https://tools.ietf.org/html/rfc2388">rfc2388</a> çš„ multipart/form-data äº†è§£ä¸€ä¸‹</p>

<h3 id="ç¬¬äºŒæ­¥-1">ç¬¬äºŒæ­¥</h3>

<p>æˆ‘ä»¬åœ¨ç¬¬ä¸€æ­¥å·²ç»å°† file é‡æ–°å°è£…äº†ä¸€å±‚ï¼Œåœ¨è¿™ä¸€æ­¥æˆ‘ä»¬å°†åŸå…ˆ logging åŒ…çš„æ–¹æ³•éƒ½ä¿®æ”¹æ‰</p>

<p>1ã€æ‰“å¼€ pkg/logging/file.go æ–‡ä»¶ï¼Œä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼š</p>

<pre><code class="language-go">package logging

import (
	&quot;fmt&quot;
	&quot;os&quot;
	&quot;time&quot;

	&quot;github.com/zshipu/go-gin-example/pkg/setting&quot;
	&quot;github.com/zshipu/go-gin-example/pkg/file&quot;
)

func getLogFilePath() string {
	return fmt.Sprintf(&quot;%s%s&quot;, setting.AppSetting.RuntimeRootPath, setting.AppSetting.LogSavePath)
}

func getLogFileName() string {
	return fmt.Sprintf(&quot;%s%s.%s&quot;,
		setting.AppSetting.LogSaveName,
		time.Now().Format(setting.AppSetting.TimeFormat),
		setting.AppSetting.LogFileExt,
	)
}

func openLogFile(fileName, filePath string) (*os.File, error) {
	dir, err := os.Getwd()
	if err != nil {
		return nil, fmt.Errorf(&quot;os.Getwd err: %v&quot;, err)
	}

	src := dir + &quot;/&quot; + filePath
	perm := file.CheckPermission(src)
	if perm == true {
		return nil, fmt.Errorf(&quot;file.CheckPermission Permission denied src: %s&quot;, src)
	}

	err = file.IsNotExistMkDir(src)
	if err != nil {
		return nil, fmt.Errorf(&quot;file.IsNotExistMkDir src: %s, err: %v&quot;, src, err)
	}

	f, err := file.Open(src + fileName, os.O_APPEND|os.O_CREATE|os.O_WRONLY, 0644)
	if err != nil {
		return nil, fmt.Errorf(&quot;Fail to OpenFile :%v&quot;, err)
	}

	return f, nil
}
</code></pre>

<p>æˆ‘ä»¬å°†å¼•ç”¨éƒ½æ”¹ä¸ºäº† file/file.go åŒ…é‡Œçš„æ–¹æ³•</p>

<p>2ã€æ‰“å¼€ pkg/logging/log.go æ–‡ä»¶ï¼Œä¿®æ”¹æ–‡ä»¶å†…å®¹:</p>

<pre><code class="language-go">package logging

...

func Setup() {
	var err error
	filePath := getLogFilePath()
	fileName := getLogFileName()
	F, err = openLogFile(fileName, filePath)
	if err != nil {
		log.Fatalln(err)
	}

	logger = log.New(F, DefaultPrefix, log.LstdFlags)
}

...
</code></pre>

<p>ç”±äºåŸæ–¹æ³•å½¢å‚æ”¹å˜äº†ï¼Œå› æ­¤ openLogFile ä¹Ÿéœ€è¦è°ƒæ•´</p>

<h2 id="å®ç°ä¸Šä¼ å›¾ç‰‡æ¥å£">å®ç°ä¸Šä¼ å›¾ç‰‡æ¥å£</h2>

<p>è¿™ä¸€å°èŠ‚ï¼Œæˆ‘ä»¬å¼€å§‹å®ç°ä¸Šæ¬¡å›¾ç‰‡ç›¸å…³çš„ä¸€äº›æ–¹æ³•å’ŒåŠŸèƒ½</p>

<p>é¦–å…ˆéœ€è¦åœ¨ blog_article ä¸­å¢åŠ å­—æ®µ <code>cover_image_url</code>ï¼Œæ ¼å¼ä¸º <code>varchar(255) DEFAULT '' COMMENT 'å°é¢å›¾ç‰‡åœ°å€'</code></p>

<h3 id="ç¬¬é›¶æ­¥">ç¬¬é›¶æ­¥</h3>

<p>ä¸€èˆ¬ä¸ä¼šç›´æ¥å°†ä¸Šä¼ çš„å›¾ç‰‡åæš´éœ²å‡ºæ¥ï¼Œå› æ­¤æˆ‘ä»¬å¯¹å›¾ç‰‡åè¿›è¡Œ MD5 æ¥è¾¾åˆ°è¿™ä¸ªæ•ˆæœ</p>

<p>åœ¨ util ç›®å½•ä¸‹æ–°å»º md5.goï¼Œå†™å…¥æ–‡ä»¶å†…å®¹ï¼š</p>

<pre><code class="language-go">package util

import (
	&quot;crypto/md5&quot;
	&quot;encoding/hex&quot;
)

func EncodeMD5(value string) string {
	m := md5.New()
	m.Write([]byte(value))

	return hex.EncodeToString(m.Sum(nil))
}

</code></pre>

<h3 id="ç¬¬ä¸€æ­¥-2">ç¬¬ä¸€æ­¥</h3>

<p>åœ¨å…ˆå‰æˆ‘ä»¬å·²ç»æŠŠåº•å±‚æ–¹æ³•ç»™å°è£…å¥½äº†ï¼Œå®è´¨è¿™ä¸€æ­¥ä¸ºå°è£… image çš„å¤„ç†é€»è¾‘</p>

<p>åœ¨ pkg ç›®å½•ä¸‹æ–°å»º upload/image.go æ–‡ä»¶ï¼Œå†™å…¥æ–‡ä»¶å†…å®¹ï¼š</p>

<pre><code class="language-go">package upload

import (
	&quot;os&quot;
	&quot;path&quot;
	&quot;log&quot;
	&quot;fmt&quot;
	&quot;strings&quot;
	&quot;mime/multipart&quot;

	&quot;github.com/zshipu/go-gin-example/pkg/file&quot;
	&quot;github.com/zshipu/go-gin-example/pkg/setting&quot;
	&quot;github.com/zshipu/go-gin-example/pkg/logging&quot;
	&quot;github.com/zshipu/go-gin-example/pkg/util&quot;
)

func GetImageFullUrl(name string) string {
	return setting.AppSetting.ImagePrefixUrl + &quot;/&quot; + GetImagePath() + name
}

func GetImageName(name string) string {
	ext := path.Ext(name)
	fileName := strings.TrimSuffix(name, ext)
	fileName = util.EncodeMD5(fileName)

	return fileName + ext
}

func GetImagePath() string {
	return setting.AppSetting.ImageSavePath
}

func GetImageFullPath() string {
	return setting.AppSetting.RuntimeRootPath + GetImagePath()
}

func CheckImageExt(fileName string) bool {
	ext := file.GetExt(fileName)
	for _, allowExt := range setting.AppSetting.ImageAllowExts {
		if strings.ToUpper(allowExt) == strings.ToUpper(ext) {
			return true
		}
	}

	return false
}

func CheckImageSize(f multipart.File) bool {
	size, err := file.GetSize(f)
	if err != nil {
		log.Println(err)
		logging.Warn(err)
		return false
	}

	return size &lt;= setting.AppSetting.ImageMaxSize
}

func CheckImage(src string) error {
	dir, err := os.Getwd()
	if err != nil {
		return fmt.Errorf(&quot;os.Getwd err: %v&quot;, err)
	}

	err = file.IsNotExistMkDir(dir + &quot;/&quot; + src)
	if err != nil {
		return fmt.Errorf(&quot;file.IsNotExistMkDir err: %v&quot;, err)
	}

	perm := file.CheckPermission(src)
	if perm == true {
		return fmt.Errorf(&quot;file.CheckPermission Permission denied src: %s&quot;, src)
	}

	return nil
}
</code></pre>

<p>åœ¨è¿™é‡Œæˆ‘ä»¬å®ç°äº† 7 ä¸ªæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>

<ul>
<li>GetImageFullUrlï¼šè·å–å›¾ç‰‡å®Œæ•´è®¿é—® URL</li>
<li>GetImageNameï¼šè·å–å›¾ç‰‡åç§°</li>
<li>GetImagePathï¼šè·å–å›¾ç‰‡è·¯å¾„</li>
<li>GetImageFullPathï¼šè·å–å›¾ç‰‡å®Œæ•´è·¯å¾„</li>
<li>CheckImageExtï¼šæ£€æŸ¥å›¾ç‰‡åç¼€</li>
<li>CheckImageSizeï¼šæ£€æŸ¥å›¾ç‰‡å¤§å°</li>
<li>CheckImageï¼šæ£€æŸ¥å›¾ç‰‡</li>
</ul>

<p>è¿™é‡ŒåŸºæœ¬æ˜¯å¯¹åº•å±‚ä»£ç çš„äºŒæ¬¡å°è£…ï¼Œä¸ºäº†æ›´çµæ´»çš„å¤„ç†ä¸€äº›å›¾ç‰‡ç‰¹æœ‰çš„é€»è¾‘ï¼Œå¹¶ä¸”æ–¹ä¾¿ä¿®æ”¹ï¼Œä¸ç›´æ¥å¯¹å¤–æš´éœ²ä¸‹å±‚</p>

<h3 id="ç¬¬äºŒæ­¥-2">ç¬¬äºŒæ­¥</h3>

<p>è¿™ä¸€æ­¥å°†ç¼–å†™ä¸Šä¼ å›¾ç‰‡çš„ä¸šåŠ¡é€»è¾‘ï¼Œåœ¨ routers/api ç›®å½•ä¸‹ æ–°å»º upload.go æ–‡ä»¶ï¼Œå†™å…¥æ–‡ä»¶å†…å®¹:</p>

<pre><code class="language-go">package api

import (
	&quot;net/http&quot;

	&quot;github.com/gin-gonic/gin&quot;

	&quot;github.com/zshipu/go-gin-example/pkg/e&quot;
	&quot;github.com/zshipu/go-gin-example/pkg/logging&quot;
	&quot;github.com/zshipu/go-gin-example/pkg/upload&quot;
)

func UploadImage(c *gin.Context) {
	code := e.SUCCESS
	data := make(map[string]string)

	file, image, err := c.Request.FormFile(&quot;image&quot;)
	if err != nil {
		logging.Warn(err)
		code = e.ERROR
		c.JSON(http.StatusOK, gin.H{
			&quot;code&quot;: code,
			&quot;msg&quot;:  e.GetMsg(code),
			&quot;data&quot;: data,
		})
	}

	if image == nil {
		code = e.INVALID_PARAMS
	} else {
		imageName := upload.GetImageName(image.Filename)
		fullPath := upload.GetImageFullPath()
		savePath := upload.GetImagePath()

		src := fullPath + imageName
		if ! upload.CheckImageExt(imageName) || ! upload.CheckImageSize(file) {
			code = e.ERROR_UPLOAD_CHECK_IMAGE_FORMAT
		} else {
			err := upload.CheckImage(fullPath)
			if err != nil {
				logging.Warn(err)
				code = e.ERROR_UPLOAD_CHECK_IMAGE_FAIL
			} else if err := c.SaveUploadedFile(image, src); err != nil {
				logging.Warn(err)
				code = e.ERROR_UPLOAD_SAVE_IMAGE_FAIL
			} else {
				data[&quot;image_url&quot;] = upload.GetImageFullUrl(imageName)
				data[&quot;image_save_url&quot;] = savePath + imageName
			}
		}
	}

	c.JSON(http.StatusOK, gin.H{
		&quot;code&quot;: code,
		&quot;msg&quot;:  e.GetMsg(code),
		&quot;data&quot;: data,
	})
}
</code></pre>

<p>æ‰€æ¶‰åŠçš„é”™è¯¯ç ï¼ˆéœ€åœ¨ pkg/e/code.goã€msg.go æ·»åŠ ï¼‰ï¼š</p>

<pre><code class="language-go">// ä¿å­˜å›¾ç‰‡å¤±è´¥
ERROR_UPLOAD_SAVE_IMAGE_FAIL = 30001
// æ£€æŸ¥å›¾ç‰‡å¤±è´¥
ERROR_UPLOAD_CHECK_IMAGE_FAIL = 30002
// æ ¡éªŒå›¾ç‰‡é”™è¯¯ï¼Œå›¾ç‰‡æ ¼å¼æˆ–å¤§å°æœ‰é—®é¢˜
ERROR_UPLOAD_CHECK_IMAGE_FORMAT = 30003
</code></pre>

<p>åœ¨è¿™ä¸€å¤§æ®µçš„ä¸šåŠ¡é€»è¾‘ä¸­ï¼Œæˆ‘ä»¬åšäº†å¦‚ä¸‹äº‹æƒ…ï¼š</p>

<ul>
<li>c.Request.FormFileï¼šè·å–ä¸Šä¼ çš„å›¾ç‰‡ï¼ˆè¿”å›æä¾›çš„è¡¨å•é”®çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼‰</li>
<li>CheckImageExtã€CheckImageSize æ£€æŸ¥å›¾ç‰‡å¤§å°ï¼Œæ£€æŸ¥å›¾ç‰‡åç¼€</li>
<li>CheckImageï¼šæ£€æŸ¥ä¸Šä¼ å›¾ç‰‡æ‰€éœ€ï¼ˆæƒé™ã€æ–‡ä»¶å¤¹ï¼‰</li>
<li>SaveUploadedFileï¼šä¿å­˜å›¾ç‰‡</li>
</ul>

<p>æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯ å…¥å‚ -&gt; æ£€æŸ¥ -ã€‹ ä¿å­˜ çš„åº”ç”¨æµç¨‹</p>

<h3 id="ç¬¬ä¸‰æ­¥">ç¬¬ä¸‰æ­¥</h3>

<p>æ‰“å¼€ routers/router.go æ–‡ä»¶ï¼Œå¢åŠ è·¯ç”± <code>r.POST(&quot;/upload&quot;, api.UploadImage)</code> ï¼Œå¦‚ï¼š</p>

<pre><code class="language-go">func InitRouter() *gin.Engine {
	r := gin.New()
    ...
	r.GET(&quot;/auth&quot;, api.GetAuth)
	r.GET(&quot;/swagger/*any&quot;, ginSwagger.WrapHandler(swaggerFiles.Handler))
	r.POST(&quot;/upload&quot;, api.UploadImage)

	apiv1 := r.Group(&quot;/api/v1&quot;)
	apiv1.Use(jwt.JWT())
	{
		...
	}

	return r
}
</code></pre>

<h3 id="éªŒè¯-1">éªŒè¯</h3>

<p>æœ€åæˆ‘ä»¬è¯·æ±‚ä¸€ä¸‹ä¸Šä¼ å›¾ç‰‡çš„æ¥å£ï¼Œæµ‹è¯•æ‰€ç¼–å†™çš„åŠŸèƒ½</p>

<p><img src="https://s2.ax1x.com/2020/02/15/1xumb8.jpg" alt="image" /></p>

<p>æ£€æŸ¥ç›®å½•ä¸‹æ˜¯å¦å«æ–‡ä»¶ï¼ˆæ³¨æ„æƒé™é—®é¢˜ï¼‰</p>

<pre><code>$ pwd
$GOPATH/src/github.com/zshipu/go-gin-example/runtime/upload/images

$ ll
... 96a3be3cf272e017046d1b2674a52bd3.jpg
... c39fa784216313cf2faa7c98739fc367.jpeg
</code></pre>

<p>åœ¨è¿™é‡Œæˆ‘ä»¬ä¸€å…±è¿”å›äº† 2 ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å®Œæ•´çš„è®¿é—® URLï¼Œå¦ä¸€ä¸ªä¸ºä¿å­˜è·¯å¾„</p>

<h2 id="å®ç°-http-fileserver">å®ç° http.FileServer</h2>

<p>åœ¨å®Œæˆäº†ä¸Šä¸€å°èŠ‚åï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®©å‰ç«¯èƒ½å¤Ÿè®¿é—®åˆ°å›¾ç‰‡ï¼Œä¸€èˆ¬æ˜¯å¦‚ä¸‹ï¼š</p>

<ul>
<li>CDN</li>
<li>http.FileSystem</li>
</ul>

<p>åœ¨å…¬å¸çš„è¯ï¼ŒCDN æˆ–è‡ªå»ºåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå±…å¤šï¼Œä¹Ÿä¸éœ€è¦è¿‡å¤šå…³æ³¨ã€‚è€Œåœ¨å®è·µé‡Œçš„è¯è‚¯å®šæ˜¯æœ¬åœ°æ­å»ºäº†ï¼ŒGo æœ¬èº«å¯¹æ­¤å°±æœ‰å¾ˆå¥½çš„æ”¯æŒï¼Œè€Œ Gin æ›´æ˜¯å†å°è£…äº†ä¸€å±‚ï¼Œåªéœ€è¦åœ¨è·¯ç”±å¢åŠ ä¸€è¡Œä»£ç å³å¯</p>

<h3 id="r-staticfs">r.StaticFS</h3>

<p>æ‰“å¼€ routers/router.go æ–‡ä»¶ï¼Œå¢åŠ è·¯ç”± <code>r.StaticFS(&quot;/upload/images&quot;, http.Dir(upload.GetImageFullPath()))</code>ï¼Œå¦‚ï¼š</p>

<pre><code class="language-go">func InitRouter() *gin.Engine {
    ...
	r.StaticFS(&quot;/upload/images&quot;, http.Dir(upload.GetImageFullPath()))

	r.GET(&quot;/auth&quot;, api.GetAuth)
	r.GET(&quot;/swagger/*any&quot;, ginSwagger.WrapHandler(swaggerFiles.Handler))
	r.POST(&quot;/upload&quot;, api.UploadImage)
    ...
}
</code></pre>

<h3 id="å®ƒåšäº†ä»€ä¹ˆ">å®ƒåšäº†ä»€ä¹ˆ</h3>

<p>å½“è®¿é—® $HOST/upload/images æ—¶ï¼Œå°†ä¼šè¯»å–åˆ° $GOPATH/src/github.com/zshipu/go-gin-example/runtime/upload/images ä¸‹çš„æ–‡ä»¶</p>

<p>è€Œè¿™è¡Œä»£ç åˆåšäº†ä»€ä¹ˆäº‹å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ–¹æ³•åŸå‹</p>

<pre><code class="language-go">// StaticFS works just like `Static()` but a custom `http.FileSystem` can be used instead.
// Gin by default user: gin.Dir()
func (group *RouterGroup) StaticFS(relativePath string, fs http.FileSystem) IRoutes {
	if strings.Contains(relativePath, &quot;:&quot;) || strings.Contains(relativePath, &quot;*&quot;) {
		panic(&quot;URL parameters can not be used when serving a static folder&quot;)
	}
	handler := group.createStaticHandler(relativePath, fs)
	urlPattern := path.Join(relativePath, &quot;/*filepath&quot;)

	// Register GET and HEAD handlers
	group.GET(urlPattern, handler)
	group.HEAD(urlPattern, handler)
	return group.returnObj()
}
</code></pre>

<p>é¦–å…ˆåœ¨æš´éœ²çš„ URL ä¸­ç¦æ­¢äº† * å’Œ : ç¬¦å·çš„ä½¿ç”¨ï¼Œé€šè¿‡ <code>createStaticHandler</code> åˆ›å»ºäº†é™æ€æ–‡ä»¶æœåŠ¡ï¼Œå®è´¨æœ€ç»ˆè°ƒç”¨çš„è¿˜æ˜¯ <code>fileServer.ServeHTTP</code> å’Œä¸€äº›å¤„ç†é€»è¾‘äº†</p>

<pre><code class="language-go">func (group *RouterGroup) createStaticHandler(relativePath string, fs http.FileSystem) HandlerFunc {
	absolutePath := group.calculateAbsolutePath(relativePath)
	fileServer := http.StripPrefix(absolutePath, http.FileServer(fs))
	_, nolisting := fs.(*onlyfilesFS)
	return func(c *Context) {
		if nolisting {
			c.Writer.WriteHeader(404)
		}
		fileServer.ServeHTTP(c.Writer, c.Request)
	}
}
</code></pre>

<h4 id="http-stripprefix">http.StripPrefix</h4>

<p>æˆ‘ä»¬å¯ä»¥ç•™æ„ä¸‹ <code>fileServer := http.StripPrefix(absolutePath, http.FileServer(fs))</code> è¿™æ®µè¯­å¥ï¼Œåœ¨é™æ€æ–‡ä»¶æœåŠ¡ä¸­å¾ˆå¸¸è§ï¼Œå®ƒæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p>

<p><code>http.StripPrefix</code> ä¸»è¦ä½œç”¨æ˜¯ä»è¯·æ±‚ URL çš„è·¯å¾„ä¸­åˆ é™¤ç»™å®šçš„å‰ç¼€ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ª <code>Handler</code></p>

<p>é€šå¸¸ http.FileServer è¦ä¸ http.StripPrefix ç›¸ç»“åˆä½¿ç”¨ï¼Œå¦åˆ™å½“ä½ è¿è¡Œï¼š</p>

<pre><code class="language-go">http.Handle(&quot;/upload/images&quot;, http.FileServer(http.Dir(&quot;upload/images&quot;)))
</code></pre>

<p>ä¼šæ— æ³•æ­£ç¡®çš„è®¿é—®åˆ°æ–‡ä»¶ç›®å½•ï¼Œå› ä¸º <code>/upload/images</code> ä¹ŸåŒ…å«åœ¨äº† URL è·¯å¾„ä¸­ï¼Œå¿…é¡»ä½¿ç”¨ï¼š</p>

<pre><code class="language-go">http.Handle(&quot;/upload/images&quot;, http.StripPrefix(&quot;upload/images&quot;, http.FileServer(http.Dir(&quot;upload/images&quot;))))
</code></pre>

<h4 id="filepath">/*filepath</h4>

<p>åˆ°ä¸‹é¢å¯ä»¥çœ‹åˆ° <code>urlPattern := path.Join(relativePath, &quot;/*filepath&quot;)</code>ï¼Œ<code>/*filepath</code> ä½ æ˜¯è°ï¼Œä½ åœ¨è¿™é‡Œæœ‰ä»€ä¹ˆç”¨ï¼Œä½ æ˜¯ Gin çš„äº§ç‰©å—?</p>

<p>é€šè¿‡è¯­ä¹‰å¯å¾—çŸ¥æ˜¯è·¯ç”±çš„å¤„ç†é€»è¾‘ï¼Œè€Œ Gin çš„è·¯ç”±æ˜¯åŸºäº httprouter çš„ï¼Œé€šè¿‡æŸ¥é˜…æ–‡æ¡£å¯å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯</p>

<pre><code>Pattern: /src/*filepath

 /src/                     match
 /src/somefile.go          match
 /src/subdir/somefile.go   match
</code></pre>

<p><code>*filepath</code> å°†åŒ¹é…æ‰€æœ‰æ–‡ä»¶è·¯å¾„ï¼Œå¹¶ä¸” <code>*filepath</code> å¿…é¡»åœ¨ Pattern çš„æœ€å</p>

<h3 id="éªŒè¯-2">éªŒè¯</h3>

<p>é‡æ–°æ‰§è¡Œ <code>go run main.go</code> ï¼Œå»è®¿é—®åˆšåˆšåœ¨ upload æ¥å£å¾—åˆ°çš„å›¾ç‰‡åœ°å€ï¼Œæ£€æŸ¥ http.FileSystem æ˜¯å¦æ­£å¸¸</p>

<p><img src="https://s2.ax1x.com/2020/02/15/1xu4Gd.jpg" alt="image" /></p>

<h2 id="ä¿®æ”¹æ–‡ç« æ¥å£">ä¿®æ”¹æ–‡ç« æ¥å£</h2>

<p>æ¥ä¸‹æ¥ï¼Œéœ€è¦ä½ ä¿®æ”¹ routers/api/v1/article.go çš„ AddArticleã€EditArticle ä¸¤ä¸ªæ¥å£</p>

<ul>
<li>æ–°å¢ã€æ›´æ–°æ–‡ç« æ¥å£ï¼šæ”¯æŒå…¥å‚ cover_image_url</li>
<li>æ–°å¢ã€æ›´æ–°æ–‡ç« æ¥å£ï¼šå¢åŠ å¯¹ cover_image_url çš„éç©ºã€æœ€é•¿é•¿åº¦æ ¡éªŒ</li>
</ul>

<p>è¿™å—å‰é¢æ–‡ç« è®²è¿‡ï¼Œå¦‚æœæœ‰é—®é¢˜å¯ä»¥å‚è€ƒé¡¹ç›®çš„ä»£ç  ğŸ‘Œ</p>

<h2 id="æ€»ç»“">æ€»ç»“</h2>

<p>åœ¨è¿™ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ç®€å•çš„åˆ†æäº†ä¸‹éœ€æ±‚ï¼Œå¯¹åº”ç”¨åšå‡ºäº†ä¸€ä¸ªå°è§„åˆ’å¹¶å®æ–½</p>

<p>å®Œæˆäº†æ¸…å•ä¸­çš„åŠŸèƒ½ç‚¹å’Œä¼˜åŒ–ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ä¹Ÿæ˜¯å¸¸è§çš„åœºæ™¯ï¼Œå¸Œæœ›ä½ èƒ½å¤Ÿç»†ç»†å“å°å¹¶é’ˆå¯¹ä¸€äº›ç‚¹è¿›è¡Œæ·±å…¥å­¦ä¹ </p>

        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>åŸæ–‡ä½œè€…ï¼š</strong><a rel="author" href="https://go.zshipu.com/">çŸ¥è¯†é“º</a></li>
        <li style="word-break:break-all"><strong>åŸæ–‡é“¾æ¥ï¼š</strong><a href="https://go.zshipu.com/posts/go/gin/2018-05-27-config-upload/">https://go.zshipu.com/posts/go/gin/2018-05-27-config-upload/</a></li>
        <li><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬ä½œå“é‡‡ç”¨<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™…è®¸å¯åè®®</a>è¿›è¡Œè®¸å¯ï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼ˆä½œè€…ï¼ŒåŸæ–‡é“¾æ¥ï¼‰ï¼Œå•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒã€‚</li>
        <li><strong>å…è´£å£°æ˜ï¼š</strong>æœ¬é¡µé¢å†…å®¹å‡æ¥æºäºç«™å†…ç¼–è¾‘å‘å¸ƒï¼Œéƒ¨åˆ†ä¿¡æ¯æ¥æºäº’è”ç½‘ï¼Œå¹¶ä¸æ„å‘³ç€æœ¬ç«™èµåŒå…¶è§‚ç‚¹æˆ–è€…è¯å®å…¶å†…å®¹çš„çœŸå®æ€§ï¼Œå¦‚æ¶‰åŠç‰ˆæƒç­‰é—®é¢˜ï¼Œè¯·ç«‹å³è”ç³»å®¢æœè¿›è¡Œæ›´æ”¹æˆ–åˆ é™¤ï¼Œä¿è¯æ‚¨çš„åˆæ³•æƒç›Šã€‚è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚ä¹Ÿå¯ä»¥é‚®ä»¶è‡³ sblig@126.com</li>
    </ul>
</div>
<br/>



        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/go/gin/2018-04-29-cron/">ã€Œè¿è½½åä¸€ã€Cronå®šæ—¶ä»»åŠ¡</a></li>
        
        <li><a href="/posts/go/gin/2018-04-15-gorm-callback/">ã€Œè¿è½½åã€å®šåˆ¶ GORM Callbacks</a></li>
        
        <li><a href="/posts/go/gin/2018-03-26-cgo/">ã€Œç•ªå¤–ã€Golang äº¤å‰ç¼–è¯‘</a></li>
        
        <li><a href="/posts/go/gin/2018-03-24-golang-docker/">ã€Œè¿è½½ä¹ã€å°†Golangåº”ç”¨éƒ¨ç½²åˆ°Docker</a></li>
        
        <li><a href="/posts/go/gin/2018-03-18-swagger/">ã€Œè¿è½½å…«ã€ä¸ºå®ƒåŠ ä¸ŠSwagger</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='/tags/go'>go</a></li>
                
                <li><a href='/tags/gin'>gin</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "zshipu/zshipu-go"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2021 <a href="https://go.zshipu.com/">çŸ¥è¯†é“ºçš„åšå®¢ By çŸ¥è¯†é“º</a>
        
        | <a rel="nofollow" target="_blank" href="https://beian.miit.gov.cn/">æµ™ ICP å¤‡19032823å·-1</a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">é£é›ªæ— æƒ…</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://go.zshipu.com/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://go.zshipu.com/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">æœ€è¿‘æ–‡ç« </h3>
<ul class="widget-list">
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go1.16-3/" title="Go1.16 æ–°ç‰¹æ€§ï¼šè¯¦è§£å†…å­˜ç®¡ç†æœºåˆ¶çš„å˜æ›´ï¼Œä½ éœ€è¦äº†è§£">Go1.16 æ–°ç‰¹æ€§ï¼šè¯¦è§£å†…å­˜ç®¡ç†æœºåˆ¶çš„å˜æ›´ï¼Œä½ éœ€è¦äº†è§£</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go1.16-2/" title="Go1.16 æ–°ç‰¹æ€§ï¼šå¿«é€Ÿä¸Šæ‰‹ Go embed">Go1.16 æ–°ç‰¹æ€§ï¼šå¿«é€Ÿä¸Šæ‰‹ Go embed</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go1.16-1/" title="Go1.16 å³å°†æ­£å¼å‘å¸ƒï¼Œä»¥ä¸‹å˜æ›´ä½ éœ€è¦çŸ¥é“">Go1.16 å³å°†æ­£å¼å‘å¸ƒï¼Œä»¥ä¸‹å˜æ›´ä½ éœ€è¦çŸ¥é“</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/generics-proposal/" title="å¿«æŠ¥ï¼šæ­£å¼ææ¡ˆå°†æ³›å‹ç‰¹æ€§åŠ å…¥ Go è¯­è¨€">å¿«æŠ¥ï¼šæ­£å¼ææ¡ˆå°†æ³›å‹ç‰¹æ€§åŠ å…¥ Go è¯­è¨€</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/2021-ecug/" title="æ¨èä¸€ä¸ªç‰›é€¼çš„æŠ€æœ¯ç¤¾åŒºï¼">æ¨èä¸€ä¸ªç‰›é€¼çš„æŠ€æœ¯ç¤¾åŒºï¼</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/2020-top100/" title="åè¡€æ•´ç† | å¿«é€Ÿäº†è§£å…¨çƒè½¯ä»¶æ¡ˆä¾‹ï¼ˆTop100ï¼‰">åè¡€æ•´ç† | å¿«é€Ÿäº†è§£å…¨çƒè½¯ä»¶æ¡ˆä¾‹ï¼ˆTop100ï¼‰</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go-error2panic/" title="Go é”™è¯¯å¤„ç†ï¼šç”¨ panic å–ä»£ err != nil çš„æ¨¡å¼">Go é”™è¯¯å¤„ç†ï¼šç”¨ panic å–ä»£ err != nil çš„æ¨¡å¼</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go-concurrent-lock/" title="Go å¹¶å‘ï¼šä¸€äº›æœ‰è¶£çš„ç°è±¡å’Œè¦é¿å¼€çš„ â€œå‘â€">Go å¹¶å‘ï¼šä¸€äº›æœ‰è¶£çš„ç°è±¡å’Œè¦é¿å¼€çš„ â€œå‘â€</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go2-errors/" title="å…ˆç¹ä¸ºå¿«ï¼ŒGo2 Error çš„æŒ£æ‰ä¹‹è·¯">å…ˆç¹ä¸ºå¿«ï¼ŒGo2 Error çš„æŒ£æ‰ä¹‹è·¯</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/gophercon2020-errors/" title="é‡ç£…ï¼šGo errors å°†ä¸ä¼šæœ‰ä»»ä½•è¿›ä¸€æ­¥çš„æ”¹è¿›è®¡åˆ’">é‡ç£…ï¼šGo errors å°†ä¸ä¼šæœ‰ä»»ä½•è¿›ä¸€æ­¥çš„æ”¹è¿›è®¡åˆ’</a>
    </li>
    
</ul>
    </section>

    
<section class="widget">
    <h3 class="widget-title" style="color:red">ç¦åˆ©æ´¾é€</h3>
    <ul class="widget-list">
        
        <li>
            <a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?source=5176.11533457&amp;userCode=tzm8r4hc" title="ã€2019åŒ12ã€‘ALL IN CLoud ä½è‡³1æŠ˜" target="_blank" style="color:red">
                
                    <img src="https://img.alicdn.com/tfs/TB1_rYHo7P2gK0jSZPxXXacQpXa-690-388.jpg">
                
            </a>
        </li>
        
        <li>
            <a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?source=5176.11533457&amp;userCode=tzm8r4hc" title="åŠ©åŠ›äº§ä¸šæ™ºæ…§å‡çº§ï¼Œäº‘æœåŠ¡å™¨é¦–å¹´88å…ƒèµ·ï¼Œæ›´æœ‰åƒå…ƒä»£é‡‘åˆ¸ç¤¼åŒ…å…è´¹é¢†ï¼" target="_blank" style="color:red">
                
                    <img src="https://upload-dianshi-1255598498.file.myqcloud.com/345-7c71532bd4935fbdd9a67c1a71e577b1767b805c.200%E7%89%88%E6%9C%ACB.jpg">
                
            </a>
        </li>
        
        <li>
            <a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?source=5176.11533457&amp;userCode=tzm8r4hc" title="ã€æ¸ é“ä¸“äº«ä½æŠ˜æ‰£ã€‘11æœˆç‰¹æƒ  é™æ—¶2æŠ˜" target="_blank" style="color:red">
                
                    <img src="https://img.alicdn.com/tfs/TB1hblJl7Y2gK0jSZFgXXc5OFXa-750-400.jpg">
                
            </a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title"><a href='/categories/'>åˆ†ç±»</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/tags/'>æ ‡ç­¾</a></h3>
<div class="tagcloud">
    
    <a href="https://go.zshipu.com/tags/ecug/">ecug</a>
    
    <a href="https://go.zshipu.com/tags/gin/">gin</a>
    
    <a href="https://go.zshipu.com/tags/go/">go</a>
    
    <a href="https://go.zshipu.com/tags/go-modules/">go-modules</a>
    
    <a href="https://go.zshipu.com/tags/grpc/">grpc</a>
    
    <a href="https://go.zshipu.com/tags/grpc-gateway/">grpc-gateway</a>
    
    <a href="https://go.zshipu.com/tags/kubernetes/">kubernetes</a>
    
    <a href="https://go.zshipu.com/tags/prometheus/">prometheus</a>
    
    <a href="https://go.zshipu.com/tags/protobuf/">protobuf</a>
    
    <a href="https://go.zshipu.com/tags/top100/">top100</a>
    
    <a href="https://go.zshipu.com/tags/untagged/">untagged</a>
    
    <a href="https://go.zshipu.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">å¾®æœåŠ¡</a>
    
    <a href="https://go.zshipu.com/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">æ•°æ®åˆ†æ</a>
    
    <a href="https://go.zshipu.com/tags/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">æœåŠ¡æ²»ç†</a>
    
    <a href="https://go.zshipu.com/tags/%E6%B3%9B%E5%9E%8B/">æ³›å‹</a>
    
    <a href="https://go.zshipu.com/tags/%E6%B7%B1%E5%BA%A6%E8%A7%A3%E5%AF%86/">æ·±åº¦è§£å¯†</a>
    
    <a href="https://go.zshipu.com/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">æºç åˆ†æ</a>
    
    <a href="https://go.zshipu.com/tags/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/">ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">å‹æƒ…é“¾æ¥</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://blog.zshipu.com//" title="çŸ¥è¯†é“ºçš„åšå®¢">çŸ¥è¯†é“ºçš„åšå®¢</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">å…¶å®ƒ</h3>
        <ul class="widget-list">
            <li><a href="https://go.zshipu.com/index.xml">æ–‡ç«  RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>