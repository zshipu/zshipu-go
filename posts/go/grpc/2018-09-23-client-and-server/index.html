<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>ã€Œè¿è½½äºŒã€gRPC Client and Server | çŸ¥è¯†é“ºçš„åšå®¢</title>
    <meta property="og:title" content="ã€Œè¿è½½äºŒã€gRPC Client and Server - çŸ¥è¯†é“ºçš„åšå®¢">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2018-09-23T12:30:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2018-09-23T12:30:00&#43;08:00'>
        
    <meta name="Keywords" content="golang,goè¯­è¨€,goè¯­è¨€ç¬”è®°,çŸ¥è¯†é“º,java,android,åšå®¢,é¡¹ç›®ç®¡ç†,python,è½¯ä»¶æ¶æ„,å…¬ä¼—å·,å°ç¨‹åº">
    <meta name="description" content="ã€Œè¿è½½äºŒã€gRPC Client and Server">
        <meta name="author" content="çŸ¥è¯†é“º">
        
    <meta property="og:url" content="https://go.zshipu.com/posts/go/grpc/2018-09-23-client-and-server/">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    <script data-ad-client="ca-pub-2874221941555456" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
    
    
    
    
    
    
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WLWJSST');</script>
    
</head>


<body>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WLWJSST"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://go.zshipu.com/">
                        çŸ¥è¯†é“ºçš„åšå®¢
                    </a>
                
                <p class="description">ä¸“æ³¨äºAndroidã€Javaã€Goè¯­è¨€(golang)ã€ç§»åŠ¨äº’è”ç½‘ã€é¡¹ç›®ç®¡ç†ã€è½¯ä»¶æ¶æ„</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://go.zshipu.com/">é¦–é¡µ</a>
                    
                    <a  href="https://go.zshipu.com/archives/" title="å½’æ¡£">å½’æ¡£</a>
                    
                    <a  href="https://go.zshipu.com/about/" title="å…³äº">å…³äº</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: fixed;
        width: 200px;
        margin-left: -210px;
        padding: 5px 10px;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        border: 1px solid rgba(0, 0, 0, .07);
        border-radius: 5px;
        background-color: rgba(255, 255, 255, 0.98);
        background-clip: padding-box;
        -webkit-box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        word-wrap: break-word;
        white-space: nowrap;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        z-index: 999;
        cursor: pointer;
        max-height: 70%;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="position: absolute; top: 188px;">
    <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#å‰è¨€">å‰è¨€</a></li>
<li><a href="#å®‰è£…">å®‰è£…</a>
<ul>
<li><a href="#grpc">gRPC</a></li>
<li><a href="#protocol-buffers-v3">Protocol Buffers v3</a></li>
<li><a href="#protoc-plugin">Protoc Plugin</a></li>
</ul></li>
<li><a href="#grpc-1">gRPC</a>
<ul>
<li><a href="#å›¾ç¤º">å›¾ç¤º</a></li>
<li><a href="#ç›®å½•ç»“æ„">ç›®å½•ç»“æ„</a></li>
<li><a href="#idl">IDL</a>
<ul>
<li><a href="#ç¼–å†™">ç¼–å†™</a></li>
<li><a href="#ç”Ÿæˆ">ç”Ÿæˆ</a></li>
<li><a href="#ç”Ÿæˆå">ç”Ÿæˆå</a></li>
</ul></li>
<li><a href="#server">Server</a></li>
<li><a href="#client">Client</a></li>
</ul></li>
<li><a href="#éªŒè¯">éªŒè¯</a>
<ul>
<li><a href="#å¯åŠ¨-server">å¯åŠ¨ Server</a></li>
<li><a href="#å¯åŠ¨-client">å¯åŠ¨ Client</a></li>
</ul></li>
<li><a href="#æ€»ç»“">æ€»ç»“</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            var leftPos = $("#main").offset().left;
            if(leftPos<220){
                postToc.css({"width":leftPos-10,"margin-left":(0-leftPos)})
            }

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t
                    },
                    process: {
                        position: "fixed",
                        top: 20
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }
    })
</script>
    <article class="post">
        <header>
            <h1 class="post-title">ã€Œè¿è½½äºŒã€gRPC Client and Server</h1>
        </header>
        <date class="post-meta meta-date">
            2018å¹´9æœˆ23æ—¥
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    é˜…è¯»</span></span>
        </div>
        
        
        <div class="clear" style="display: none">
            <div class="toc-article">
                <div class="toc-title">æ–‡ç« ç›®å½•</div>
            </div>
        </div>
        
        <div class="post-content">
            

<h2 id="å‰è¨€">å‰è¨€</h2>

<p>æœ¬ç« èŠ‚å°†ä½¿ç”¨ Go æ¥ç¼–å†™ gRPC Server å’Œ Clientï¼Œè®©å…¶äº’ç›¸é€šè®¯ã€‚åœ¨æ­¤ä¹‹ä¸Šä¼šä½¿ç”¨åˆ°å¦‚ä¸‹åº“ï¼š</p>

<ul>
<li>google.golang.org/grpc</li>
<li>github.com/golang/protobuf/protoc-gen-go</li>
</ul>

<h2 id="å®‰è£…">å®‰è£…</h2>

<h3 id="grpc">gRPC</h3>

<pre><code>go get -u google.golang.org/grpc
</code></pre>

<h3 id="protocol-buffers-v3">Protocol Buffers v3</h3>

<pre><code>wget https://github.com/google/protobuf/releases/download/v3.5.1/protobuf-all-3.5.1.zip
unzip protobuf-all-3.5.1.zip
cd protobuf-3.5.1/
./configure
make
make install
</code></pre>

<p>æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ</p>

<pre><code>protoc --version
</code></pre>

<p>è‹¥å‡ºç°ä»¥ä¸‹é”™è¯¯ï¼Œæ‰§è¡Œ <code>ldconfig</code> å‘½åå°±èƒ½è§£å†³è¿™é—®é¢˜</p>

<pre><code>protoc: error while loading shared libraries: libprotobuf.so.15: cannot open shared object file: No such file or directory
</code></pre>

<h3 id="protoc-plugin">Protoc Plugin</h3>

<pre><code>go get -u github.com/golang/protobuf/protoc-gen-go
</code></pre>

<p>å®‰è£…ç¯å¢ƒè‹¥æœ‰é—®é¢˜ï¼Œå¯å‚è€ƒæˆ‘å…ˆå‰çš„æ–‡ç«  <a href="https://segmentfault.com/a/1190000013339403">ã€Šä»‹ç»ä¸ç¯å¢ƒå®‰è£…ã€‹</a> å†…æœ‰è¯¦ç»†ä»‹ç»ï¼Œä¸å†èµ˜è¿°</p>

<h2 id="grpc-1">gRPC</h2>

<p>æœ¬å°èŠ‚å¼€å§‹æ­£å¼ç¼–å†™ gRPC ç›¸å…³çš„ç¨‹åºï¼Œä¸€èµ·ä¸Šè½¦å§ ğŸ˜„</p>

<h3 id="å›¾ç¤º">å›¾ç¤º</h3>

<p><img src="/posts/images/415d9544fce1e774e1095ab99b6cc015.png" alt="image" /></p>

<h3 id="ç›®å½•ç»“æ„">ç›®å½•ç»“æ„</h3>

<pre><code>$ tree go-grpc-example
go-grpc-example
â”œâ”€â”€ client
â”œâ”€â”€ proto
â”‚Â Â  â””â”€â”€ search.proto
â””â”€â”€ server.go
</code></pre>

<h3 id="idl">IDL</h3>

<h4 id="ç¼–å†™">ç¼–å†™</h4>

<p>åœ¨ proto æ–‡ä»¶å¤¹ä¸‹çš„ search.proto æ–‡ä»¶ä¸­ï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>

<pre><code>syntax = &quot;proto3&quot;;

package proto;

service SearchService {
    rpc Search(SearchRequest) returns (SearchResponse) {}
}

message SearchRequest {
    string request = 1;
}

message SearchResponse {
    string response = 1;
}
</code></pre>

<h4 id="ç”Ÿæˆ">ç”Ÿæˆ</h4>

<p>åœ¨ proto æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>

<pre><code>$ protoc --go_out=plugins=grpc:. *.proto
</code></pre>

<ul>
<li>plugins=plugin1+plugin2ï¼šæŒ‡å®šè¦åŠ è½½çš„å­æ’ä»¶åˆ—è¡¨</li>
</ul>

<p>æˆ‘ä»¬å®šä¹‰çš„ proto æ–‡ä»¶æ˜¯æ¶‰åŠäº† RPC æœåŠ¡çš„ï¼Œè€Œé»˜è®¤æ˜¯ä¸ä¼šç”Ÿæˆ RPC ä»£ç çš„ï¼Œå› æ­¤éœ€è¦ç»™å‡º <code>plugins</code> å‚æ•°ä¼ é€’ç»™ <code>protoc-gen-go</code>ï¼Œå‘Šè¯‰å®ƒï¼Œè¯·æ”¯æŒ RPCï¼ˆè¿™é‡ŒæŒ‡å®šäº† gRPCï¼‰</p>

<ul>
<li>&ndash;go_out=.ï¼šè®¾ç½® Go ä»£ç è¾“å‡ºçš„ç›®å½•</li>
</ul>

<p>è¯¥æŒ‡ä»¤ä¼šåŠ è½½ protoc-gen-go æ’ä»¶è¾¾åˆ°ç”Ÿæˆ Go ä»£ç çš„ç›®çš„ï¼Œç”Ÿæˆçš„æ–‡ä»¶ä»¥ .pb.go ä¸ºæ–‡ä»¶åç¼€</p>

<ul>
<li>: ï¼ˆå†’å·ï¼‰</li>
</ul>

<p>å†’å·å……å½“åˆ†éš”ç¬¦çš„ä½œç”¨ï¼Œåè·Ÿæ‰€éœ€è¦çš„å‚æ•°é›†ã€‚å¦‚æœè¿™å¤„ä¸æ¶‰åŠ RPCï¼Œå‘½ä»¤å¯ç®€åŒ–ä¸ºï¼š</p>

<pre><code>$ protoc --go_out=. *.proto
</code></pre>

<p>æ³¨ï¼šå»ºè®®ä½ çœ‹çœ‹ä¸¤æ¡å‘½ä»¤ç”Ÿæˆçš„ .pb.go æ–‡ä»¶ï¼Œåˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«</p>

<h4 id="ç”Ÿæˆå">ç”Ÿæˆå</h4>

<p>æ‰§è¡Œå®Œæ¯•å‘½ä»¤åï¼Œå°†å¾—åˆ°ä¸€ä¸ª .pb.go æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>

<pre><code class="language-go">type SearchRequest struct {
	Request              string   `protobuf:&quot;bytes,1,opt,name=request&quot; json:&quot;request,omitempty&quot;`
	XXX_NoUnkeyedLiteral struct{} `json:&quot;-&quot;`
	XXX_unrecognized     []byte   `json:&quot;-&quot;`
	XXX_sizecache        int32    `json:&quot;-&quot;`
}

func (m *SearchRequest) Reset()         { *m = SearchRequest{} }
func (m *SearchRequest) String() string { return proto.CompactTextString(m) }
func (*SearchRequest) ProtoMessage()    {}
func (*SearchRequest) Descriptor() ([]byte, []int) {
	return fileDescriptor_search_8b45f79ee13ff6a3, []int{0}
}

func (m *SearchRequest) GetRequest() string {
	if m != nil {
		return m.Request
	}
	return &quot;&quot;
}
</code></pre>

<p>é€šè¿‡é˜…è¯»è¿™ä¸€éƒ¨åˆ†ä»£ç ï¼Œå¯ä»¥çŸ¥é“ä¸»è¦æ¶‰åŠå¦‚ä¸‹æ–¹é¢ï¼š</p>

<ul>
<li>å­—æ®µåç§°ä»å°å†™ä¸‹åˆ’çº¿è½¬æ¢ä¸ºå¤§å†™é©¼å³°æ¨¡å¼ï¼ˆå­—æ®µå¯¼å‡ºï¼‰</li>
<li>ç”Ÿæˆä¸€ç»„ Getters æ–¹æ³•ï¼Œèƒ½ä¾¿äºå¤„ç†ä¸€äº›ç©ºæŒ‡é’ˆå–å€¼çš„æƒ…å†µ</li>
<li>ProtoMessage æ–¹æ³•å®ç° proto.Message çš„æ¥å£</li>
<li>ç”Ÿæˆ Rest æ–¹æ³•ï¼Œä¾¿äºå°† Protobuf ç»“æ„ä½“æ¢å¤ä¸ºé›¶å€¼</li>

<li><p>Repeated è½¬æ¢ä¸ºåˆ‡ç‰‡</p>

<pre><code class="language-go">type SearchRequest struct {
	Request              string   `protobuf:&quot;bytes,1,opt,name=request&quot; json:&quot;request,omitempty&quot;`
}

func (*SearchRequest) Descriptor() ([]byte, []int) {
	return fileDescriptor_search_8b45f79ee13ff6a3, []int{0}
}

type SearchResponse struct {
	Response             string   `protobuf:&quot;bytes,1,opt,name=response&quot; json:&quot;response,omitempty&quot;`
}

func (*SearchResponse) Descriptor() ([]byte, []int) {
	return fileDescriptor_search_8b45f79ee13ff6a3, []int{1}
}

...

func init() { proto.RegisterFile(&quot;search.proto&quot;, fileDescriptor_search_8b45f79ee13ff6a3) }

var fileDescriptor_search_8b45f79ee13ff6a3 = []byte{
	// 131 bytes of a gzipped FileDescriptorProto
	0x1f, 0x8b, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0xff, 0xe2, 0xe2, 0x29, 0x4e, 0x4d, 0x2c,
	0x4a, 0xce, 0xd0, 0x2b, 0x28, 0xca, 0x2f, 0xc9, 0x17, 0x62, 0x05, 0x53, 0x4a, 0x9a, 0x5c, 0xbc,
	0xc1, 0x60, 0xe1, 0xa0, 0xd4, 0xc2, 0xd2, 0xd4, 0xe2, 0x12, 0x21, 0x09, 0x2e, 0xf6, 0x22, 0x08,
	0x53, 0x82, 0x51, 0x81, 0x51, 0x83, 0x33, 0x08, 0xc6, 0x55, 0xd2, 0xe1, 0xe2, 0x83, 0x29, 0x2d,
	0x2e, 0xc8, 0xcf, 0x2b, 0x4e, 0x15, 0x92, 0xe2, 0xe2, 0x28, 0x82, 0xb2, 0xa1, 0x8a, 0xe1, 0x7c,
	0x23, 0x0f, 0x98, 0xc1, 0xc1, 0xa9, 0x45, 0x65, 0x99, 0xc9, 0xa9, 0x42, 0xe6, 0x5c, 0x6c, 0x10,
	0x01, 0x21, 0x11, 0x88, 0x13, 0xf4, 0x50, 0x2c, 0x96, 0x12, 0x45, 0x13, 0x85, 0x98, 0xa3, 0xc4,
	0x90, 0xc4, 0x06, 0x16, 0x37, 0x06, 0x04, 0x00, 0x00, 0xff, 0xff, 0xf3, 0xba, 0x74, 0x95, 0xc0,
	0x00, 0x00, 0x00,
}
</code></pre></li>
</ul>

<p>è€Œè¿™ä¸€éƒ¨åˆ†ä»£ç ä¸»è¦æ˜¯å›´ç»• <code>fileDescriptor</code> è¿›è¡Œï¼Œåœ¨è¿™é‡Œ <code>fileDescriptor_search_8b45f79ee13ff6a3</code> è¡¨ç¤ºä¸€ä¸ªç¼–è¯‘åçš„ proto æ–‡ä»¶ï¼Œè€Œæ¯ä¸€ä¸ªæ–¹æ³•éƒ½åŒ…å« Descriptor æ–¹æ³•ï¼Œä»£è¡¨ç€è¿™ä¸€ä¸ªæ–¹æ³•åœ¨ <code>fileDescriptor</code> ä¸­å…·ä½“çš„ Message Field</p>

<h3 id="server">Server</h3>

<p>è¿™ä¸€å°èŠ‚å°†ç¼–å†™ gRPC Server çš„åŸºç¡€æ¨¡æ¿ï¼Œå®Œæˆä¸€ä¸ªæ–¹æ³•çš„è°ƒç”¨ã€‚å¯¹ server.go å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>

<pre><code class="language-go">package main

import (
	&quot;context&quot;
	&quot;log&quot;
	&quot;net&quot;

	&quot;google.golang.org/grpc&quot;

	pb &quot;github.com/zshipu/go-grpc-example/proto&quot;
)

type SearchService struct{}

func (s *SearchService) Search(ctx context.Context, r *pb.SearchRequest) (*pb.SearchResponse, error) {
	return &amp;pb.SearchResponse{Response: r.GetRequest() + &quot; Server&quot;}, nil
}

const PORT = &quot;9001&quot;

func main() {
	server := grpc.NewServer()
	pb.RegisterSearchServiceServer(server, &amp;SearchService{})

	lis, err := net.Listen(&quot;tcp&quot;, &quot;:&quot;+PORT)
	if err != nil {
		log.Fatalf(&quot;net.Listen err: %v&quot;, err)
	}

	server.Serve(lis)
}
</code></pre>

<ul>
<li>åˆ›å»º gRPC Server å¯¹è±¡ï¼Œä½ å¯ä»¥ç†è§£ä¸ºå®ƒæ˜¯ Server ç«¯çš„æŠ½è±¡å¯¹è±¡</li>
<li>å°† SearchServiceï¼ˆå…¶åŒ…å«éœ€è¦è¢«è°ƒç”¨çš„æœåŠ¡ç«¯æ¥å£ï¼‰æ³¨å†Œåˆ° gRPC Server çš„å†…éƒ¨æ³¨å†Œä¸­å¿ƒã€‚è¿™æ ·å¯ä»¥åœ¨æ¥å—åˆ°è¯·æ±‚æ—¶ï¼Œé€šè¿‡å†…éƒ¨çš„æœåŠ¡å‘ç°ï¼Œå‘ç°è¯¥æœåŠ¡ç«¯æ¥å£å¹¶è½¬æ¥è¿›è¡Œé€»è¾‘å¤„ç†</li>
<li>åˆ›å»º Listenï¼Œç›‘å¬ TCP ç«¯å£</li>
<li>gRPC Server å¼€å§‹ lis.Acceptï¼Œç›´åˆ° Stop æˆ– GracefulStop</li>
</ul>

<h3 id="client">Client</h3>

<p>æ¥ä¸‹æ¥ç¼–å†™ gRPC Go Client çš„åŸºç¡€æ¨¡æ¿ï¼Œæ‰“å¼€ client/client.go æ–‡ä»¶ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>

<pre><code class="language-go">package main

import (
	&quot;context&quot;
	&quot;log&quot;

	&quot;google.golang.org/grpc&quot;

	pb &quot;github.com/zshipu/go-grpc-example/proto&quot;
)

const PORT = &quot;9001&quot;

func main() {
	conn, err := grpc.Dial(&quot;:&quot;+PORT, grpc.WithInsecure())
	if err != nil {
		log.Fatalf(&quot;grpc.Dial err: %v&quot;, err)
	}
	defer conn.Close()

	client := pb.NewSearchServiceClient(conn)
	resp, err := client.Search(context.Background(), &amp;pb.SearchRequest{
		Request: &quot;gRPC&quot;,
	})
	if err != nil {
		log.Fatalf(&quot;client.Search err: %v&quot;, err)
	}

	log.Printf(&quot;resp: %s&quot;, resp.GetResponse())
}
</code></pre>

<ul>
<li>åˆ›å»ºä¸ç»™å®šç›®æ ‡ï¼ˆæœåŠ¡ç«¯ï¼‰çš„è¿æ¥äº¤äº’</li>
<li>åˆ›å»º SearchService çš„å®¢æˆ·ç«¯å¯¹è±¡</li>
<li>å‘é€ RPC è¯·æ±‚ï¼Œç­‰å¾…åŒæ­¥å“åº”ï¼Œå¾—åˆ°å›è°ƒåè¿”å›å“åº”ç»“æœ</li>
<li>è¾“å‡ºå“åº”ç»“æœ</li>
</ul>

<h2 id="éªŒè¯">éªŒè¯</h2>

<h3 id="å¯åŠ¨-server">å¯åŠ¨ Server</h3>

<pre><code class="language-sh">$ pwd
$GOPATH/github.com/zshipu/go-grpc-example
$ go run server.go
</code></pre>

<h3 id="å¯åŠ¨-client">å¯åŠ¨ Client</h3>

<pre><code class="language-sh">$ pwd
$GOPATH/github.com/zshipu/go-grpc-example/client
$ go run client.go
2018/09/23 11:06:23 resp: gRPC Server
</code></pre>

<h2 id="æ€»ç»“">æ€»ç»“</h2>

<p>åœ¨æœ¬ç« èŠ‚ï¼Œæˆ‘ä»¬å¯¹ Protobufã€gRPC Client/Server åˆ†åˆ«éƒ½è¿›è¡Œäº†ä»‹ç»ã€‚å¸Œæœ›ä½ ç»“åˆæ–‡ä¸­è®²è¿°å†…å®¹å†å†™ä¸€ä¸ª Demo è¿›è¡Œæ·±å…¥äº†è§£ï¼Œè‚¯å®šä¼šæ›´æ£’ ğŸ¤”</p>

        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>åŸæ–‡ä½œè€…ï¼š</strong><a rel="author" href="https://go.zshipu.com/">çŸ¥è¯†é“º</a></li>
        <li style="word-break:break-all"><strong>åŸæ–‡é“¾æ¥ï¼š</strong><a href="https://go.zshipu.com/posts/go/grpc/2018-09-23-client-and-server/">https://go.zshipu.com/posts/go/grpc/2018-09-23-client-and-server/</a></li>
        <li><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬ä½œå“é‡‡ç”¨<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™…è®¸å¯åè®®</a>è¿›è¡Œè®¸å¯ï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼ˆä½œè€…ï¼ŒåŸæ–‡é“¾æ¥ï¼‰ï¼Œå•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒã€‚</li>
        <li><strong>å…è´£å£°æ˜ï¼š</strong>æœ¬é¡µé¢å†…å®¹å‡æ¥æºäºç«™å†…ç¼–è¾‘å‘å¸ƒï¼Œéƒ¨åˆ†ä¿¡æ¯æ¥æºäº’è”ç½‘ï¼Œå¹¶ä¸æ„å‘³ç€æœ¬ç«™èµåŒå…¶è§‚ç‚¹æˆ–è€…è¯å®å…¶å†…å®¹çš„çœŸå®æ€§ï¼Œå¦‚æ¶‰åŠç‰ˆæƒç­‰é—®é¢˜ï¼Œè¯·ç«‹å³è”ç³»å®¢æœè¿›è¡Œæ›´æ”¹æˆ–åˆ é™¤ï¼Œä¿è¯æ‚¨çš„åˆæ³•æƒç›Šã€‚è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚ä¹Ÿå¯ä»¥é‚®ä»¶è‡³ sblig@126.com</li>
    </ul>
</div>
<br/>



        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/go/grpc/2018-09-22-install/">ã€Œè¿è½½ä¸€ã€gRPCåŠç›¸å…³ä»‹ç»</a></li>
        
        <li><a href="/posts/go/tools/2018-09-15-go-tool-pprof/">Go å¤§æ€å™¨ä¹‹æ€§èƒ½å‰–æ PProf</a></li>
        
        <li><a href="/posts/go/gin/2018-09-01-nginx/">ã€Œè¿è½½åä¸ƒã€ç”¨Nginxéƒ¨ç½²Goåº”ç”¨</a></li>
        
        <li><a href="/posts/go/gin/2018-08-26-makefile/">ã€Œç•ªå¤–ã€è¯·å…¥é—¨ Makefile</a></li>
        
        <li><a href="/posts/go/gin/2018-07-07-font/">ã€Œè¿è½½åå…­ã€åœ¨å›¾ç‰‡ä¸Šç»˜åˆ¶æ–‡å­—</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='/tags/go'>go</a></li>
                
                <li><a href='/tags/grpc'>grpc</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "zshipu/zshipu-go"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2021 <a href="https://go.zshipu.com/">çŸ¥è¯†é“ºçš„åšå®¢ By çŸ¥è¯†é“º</a>
        
        | <a rel="nofollow" target="_blank" href="https://beian.miit.gov.cn/">æµ™ ICP å¤‡19032823å·-1</a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">é£é›ªæ— æƒ…</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://go.zshipu.com/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://go.zshipu.com/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">æœ€è¿‘æ–‡ç« </h3>
<ul class="widget-list">
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go1.16-3/" title="Go1.16 æ–°ç‰¹æ€§ï¼šè¯¦è§£å†…å­˜ç®¡ç†æœºåˆ¶çš„å˜æ›´ï¼Œä½ éœ€è¦äº†è§£">Go1.16 æ–°ç‰¹æ€§ï¼šè¯¦è§£å†…å­˜ç®¡ç†æœºåˆ¶çš„å˜æ›´ï¼Œä½ éœ€è¦äº†è§£</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go1.16-2/" title="Go1.16 æ–°ç‰¹æ€§ï¼šå¿«é€Ÿä¸Šæ‰‹ Go embed">Go1.16 æ–°ç‰¹æ€§ï¼šå¿«é€Ÿä¸Šæ‰‹ Go embed</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go1.16-1/" title="Go1.16 å³å°†æ­£å¼å‘å¸ƒï¼Œä»¥ä¸‹å˜æ›´ä½ éœ€è¦çŸ¥é“">Go1.16 å³å°†æ­£å¼å‘å¸ƒï¼Œä»¥ä¸‹å˜æ›´ä½ éœ€è¦çŸ¥é“</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/generics-proposal/" title="å¿«æŠ¥ï¼šæ­£å¼ææ¡ˆå°†æ³›å‹ç‰¹æ€§åŠ å…¥ Go è¯­è¨€">å¿«æŠ¥ï¼šæ­£å¼ææ¡ˆå°†æ³›å‹ç‰¹æ€§åŠ å…¥ Go è¯­è¨€</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/2021-ecug/" title="æ¨èä¸€ä¸ªç‰›é€¼çš„æŠ€æœ¯ç¤¾åŒºï¼">æ¨èä¸€ä¸ªç‰›é€¼çš„æŠ€æœ¯ç¤¾åŒºï¼</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/2020-top100/" title="åè¡€æ•´ç† | å¿«é€Ÿäº†è§£å…¨çƒè½¯ä»¶æ¡ˆä¾‹ï¼ˆTop100ï¼‰">åè¡€æ•´ç† | å¿«é€Ÿäº†è§£å…¨çƒè½¯ä»¶æ¡ˆä¾‹ï¼ˆTop100ï¼‰</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go-error2panic/" title="Go é”™è¯¯å¤„ç†ï¼šç”¨ panic å–ä»£ err != nil çš„æ¨¡å¼">Go é”™è¯¯å¤„ç†ï¼šç”¨ panic å–ä»£ err != nil çš„æ¨¡å¼</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go-concurrent-lock/" title="Go å¹¶å‘ï¼šä¸€äº›æœ‰è¶£çš„ç°è±¡å’Œè¦é¿å¼€çš„ â€œå‘â€">Go å¹¶å‘ï¼šä¸€äº›æœ‰è¶£çš„ç°è±¡å’Œè¦é¿å¼€çš„ â€œå‘â€</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/go2-errors/" title="å…ˆç¹ä¸ºå¿«ï¼ŒGo2 Error çš„æŒ£æ‰ä¹‹è·¯">å…ˆç¹ä¸ºå¿«ï¼ŒGo2 Error çš„æŒ£æ‰ä¹‹è·¯</a>
    </li>
    
    <li>
        <a href="https://go.zshipu.com/posts/go/gophercon2020-errors/" title="é‡ç£…ï¼šGo errors å°†ä¸ä¼šæœ‰ä»»ä½•è¿›ä¸€æ­¥çš„æ”¹è¿›è®¡åˆ’">é‡ç£…ï¼šGo errors å°†ä¸ä¼šæœ‰ä»»ä½•è¿›ä¸€æ­¥çš„æ”¹è¿›è®¡åˆ’</a>
    </li>
    
</ul>
    </section>

    
<section class="widget">
    <h3 class="widget-title" style="color:red">ç¦åˆ©æ´¾é€</h3>
    <ul class="widget-list">
        
        <li>
            <a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?source=5176.11533457&amp;userCode=tzm8r4hc" title="ã€2019åŒ12ã€‘ALL IN CLoud ä½è‡³1æŠ˜" target="_blank" style="color:red">
                
                    <img src="https://img.alicdn.com/tfs/TB1_rYHo7P2gK0jSZPxXXacQpXa-690-388.jpg">
                
            </a>
        </li>
        
        <li>
            <a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?source=5176.11533457&amp;userCode=tzm8r4hc" title="åŠ©åŠ›äº§ä¸šæ™ºæ…§å‡çº§ï¼Œäº‘æœåŠ¡å™¨é¦–å¹´88å…ƒèµ·ï¼Œæ›´æœ‰åƒå…ƒä»£é‡‘åˆ¸ç¤¼åŒ…å…è´¹é¢†ï¼" target="_blank" style="color:red">
                
                    <img src="https://upload-dianshi-1255598498.file.myqcloud.com/345-7c71532bd4935fbdd9a67c1a71e577b1767b805c.200%E7%89%88%E6%9C%ACB.jpg">
                
            </a>
        </li>
        
        <li>
            <a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?source=5176.11533457&amp;userCode=tzm8r4hc" title="ã€æ¸ é“ä¸“äº«ä½æŠ˜æ‰£ã€‘11æœˆç‰¹æƒ  é™æ—¶2æŠ˜" target="_blank" style="color:red">
                
                    <img src="https://img.alicdn.com/tfs/TB1hblJl7Y2gK0jSZFgXXc5OFXa-750-400.jpg">
                
            </a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title"><a href='/categories/'>åˆ†ç±»</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/tags/'>æ ‡ç­¾</a></h3>
<div class="tagcloud">
    
    <a href="https://go.zshipu.com/tags/ecug/">ecug</a>
    
    <a href="https://go.zshipu.com/tags/gin/">gin</a>
    
    <a href="https://go.zshipu.com/tags/go/">go</a>
    
    <a href="https://go.zshipu.com/tags/go-modules/">go-modules</a>
    
    <a href="https://go.zshipu.com/tags/grpc/">grpc</a>
    
    <a href="https://go.zshipu.com/tags/grpc-gateway/">grpc-gateway</a>
    
    <a href="https://go.zshipu.com/tags/kubernetes/">kubernetes</a>
    
    <a href="https://go.zshipu.com/tags/prometheus/">prometheus</a>
    
    <a href="https://go.zshipu.com/tags/protobuf/">protobuf</a>
    
    <a href="https://go.zshipu.com/tags/top100/">top100</a>
    
    <a href="https://go.zshipu.com/tags/untagged/">untagged</a>
    
    <a href="https://go.zshipu.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">å¾®æœåŠ¡</a>
    
    <a href="https://go.zshipu.com/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">æ•°æ®åˆ†æ</a>
    
    <a href="https://go.zshipu.com/tags/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">æœåŠ¡æ²»ç†</a>
    
    <a href="https://go.zshipu.com/tags/%E6%B3%9B%E5%9E%8B/">æ³›å‹</a>
    
    <a href="https://go.zshipu.com/tags/%E6%B7%B1%E5%BA%A6%E8%A7%A3%E5%AF%86/">æ·±åº¦è§£å¯†</a>
    
    <a href="https://go.zshipu.com/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">æºç åˆ†æ</a>
    
    <a href="https://go.zshipu.com/tags/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/">ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">å‹æƒ…é“¾æ¥</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://blog.zshipu.com//" title="çŸ¥è¯†é“ºçš„åšå®¢">çŸ¥è¯†é“ºçš„åšå®¢</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">å…¶å®ƒ</h3>
        <ul class="widget-list">
            <li><a href="https://go.zshipu.com/index.xml">æ–‡ç«  RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>